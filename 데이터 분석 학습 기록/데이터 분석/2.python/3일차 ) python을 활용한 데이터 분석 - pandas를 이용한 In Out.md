[[2.python]]
## **글 쓴 이유**

 - 3일차 부터는 pandas를 사용한 파일 입출력 및 파일내 통계 데이터를 다루는 법을 정리함

 - 주로 pandas 라이브러리의 기능을 사용할 예정

 - 파일 I/O는 파이썬의 os 라이브러리 사용

## **OS 라이브러리 ??**

 **- 운영체제에서 제공하는 기능을 파이썬 코드로 제어할 수 있게 해주는 도구**

 - os.chdir('경로') : '경로'로 디렉토리 이동

 - os.getcwd() : 현재 디렉토리 출력

 - os.listdir() : 현재 디렉토리의 파일 내역 출력

## **pandas 라이브러리에서 파일 I/O 매서드 ??**

 - os 라이브러리 함수로 읽고 싶은 파일의 디렉토리로 이동했다면 이제 파일을 read 해야함

 - 이때 사용하는 함수는 pandas에서 지원해줌

 - 해당 글에서는 다음과 같은 함수를 주로 사용하였음

#### **1. pandas.read_excel : excel 파일을 읽음**

 - 우리가 데이터 분석을 위해 주로 접할 엑셀 파일을 읽기 위한 매서드임

 - 파일의 크기가 클수록 데이터 I/O 시간이 오래 걸림

 - 해당 매서드의 옵션값은 다음과 같이 설명됨

|   |   |   |
|---|---|---|
|**인수 명**|**기본값**|**설명**|
|io|필수|파일의 경로 또는 파일의 객체|
|sheet_name|0|읽어올 시트의 이름이나 인덱스(0부터 시작). None을 넣으면 모든 시트를 사전(Dict) 형태로 가져옴.|
|header|0|열 이름으로 사용할 행의 번호. 첫 행이 열 이름이 아니라면 None 설정 가능.|
|names|None|열 이름을 직접 지정하고 싶을 때 리스트 형태로 입력.|
|rhousands|None|데이터 내 천 단위 구분 기호 ','가 포함 되어 있을 경우 이를 제거 후 in/float로 인식하게 함|
|index_col|None|특정 열을 데이터프레임의 인덱스로 사용하고 싶을 때 번호나 이름 지정.|
|usecols|None|특정 열만 선택해서 읽어올 때 사용 (예: "A:C, E" 또는 [0, 1, 4]).|
|dtype|None|열의 데이터 타입을 강제로 지정 (예: {'지역코드': str} - 숫자 앞 '0' 보존 시 유용).|
|skiprows|None|파일 앞부분에서 무시할 행의 개수.|
|nrows|None|읽어올 행의 개수 (대용량 파일에서 샘플링할 때 유용).|
|na_values|None|결측치(NaN)로 처리할 추가적인 문자열 지정.|
|engine|None|엑셀 파일을 읽을 엔진 지정 (일반적으로 openpyxl을 가장 많이 사용).|

#### **2. pandas.read_csv:** **csv** **파일을 읽음**

 - 쉼표로 구분된 텍스트 파일 CSV를 읽어 데이터 프레임으로 변환해줌

 - 엑셀 파일보다 용량이 작고 처리가 빠름

 - 한글 데이터 분석시 인코딩 에러가 발생 할 수 있어 문자 인코딩이 필요 (기본 파이썬 인코딩인 UTF-8은 한글 지원을 안해줌)

 - 해당 매서드의 옵션값은 다음과 같이 설명됨

|   |   |   |
|---|---|---|
|**인수명 (Parameter)**|**기본값**|**설명**|
|filepath_or_buffer|(필수)|파일 경로, URL 또는 파일 객체.|
|sep|','|구분자 지정. 탭으로 구분된 경우 '\t', 공백은 ' ' 등으로 설정.|
|encoding|None|파일 인코딩. 한글 데이터는 주로 'utf-8' 또는 'cp949' 사용.|
|index_col|None|인덱스로 사용할 열 번호나 이름.|
|usecols|None|읽어올 열만 선택 (메모리 절약에 매우 중요).|
|dtype|None|각 열의 데이터 타입 지정 (예: {'지역코드': str}).|
|thousands|None|천 단위 구분 기호(,) 제거 후 숫자로 인식.|
|header|0|열 이름으로 사용할 행 번호.|
|low_memory|True|내부적으로 파일을 나눠서 읽음. 대용량 파일에서 경고 발생 시 False로 설정.|

## **xlsx 과 csv 파일의 장단점 비교**

|   |   |   |
|---|---|---|
|구분|xlsx 파일|csv 파일|
|장점|-  문자 인코딩 방식과 관련 없음  <br> -  xlsx 파일의 셀 서식을 유지하므로 날짜 시간형 데이터를 'datetime64[ns]' 로 생성함|- 입출력 속도가 매우 빠름|
|단점|- 입출력 속도가 매우 느림|- 문자 인코딩 방식이 인수의 기본값과 다르면 에러가 발생할 수  있음  <br> - 날짜시간형 데이터를 object로 생성함|